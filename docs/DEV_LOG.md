# 🗓️ 개발 일지 (Development Log)

> 개발자 출신 기획자를 위한 백엔드 개발 작업 기록  
> 어려운 기술 용어는 최대한 쉽게 풀어서 설명합니다.

---

## 📅 2024년 12월 26일 - 어드민 및 칼럼 관리 시스템 구축

### 🎯 오늘의 목표
마케팅 홈페이지를 운영할 수 있는 어드민 시스템을 만들었습니다. 운영자가 웹사이트에 직접 접속해서 칼럼을 올리고, 홈페이지 내용을 수정할 수 있게 했어요.

---

### 📦 1단계: 데이터베이스 설계 (오전 작업)

**뭘 했나요?**
- 서버가 데이터를 저장할 수 있도록 데이터베이스 구조를 설계했습니다.
- 마치 엑셀 시트를 여러 개 만든 것과 비슷해요.

**어떤 데이터를 저장하나요?**

#### 👤 Admin 테이블 (관리자 계정)
```
어떤 정보를 저장하나요?
- 이메일 주소 (로그인할 때 쓰는 ID)
- 비밀번호 (보안을 위해 암호화해서 저장)
- 이름 (관리자 이름)
- 역할 (대표/일반 관리자 등)
- 마지막 로그인 시간
```

**왜 필요한가요?**
- 웹사이트를 수정하려면 로그인이 필요하니까요. 아무나 못 들어오게 하기 위해서입니다.

#### 📝 Column 테이블 (칼럼/게시글)
```
어떤 정보를 저장하나요?
- 제목 (예: "병원 마케팅 전략")
- 내용 (칼럼 본문)
- 요약 (짧은 설명)
- 썸네일 이미지 주소
- 상태 (초안/발행완료/비공개)
- 작성자 정보
- 카테고리 (어느 분야 칼럼인지)
- 태그들 (검색하기 쉽게)
- 조회수 (몇 명이 봤는지)
- 발행일 (언제 올렸는지)
```

**왜 필요한가요?**
- 홈페이지에 보여줄 칼럼들의 정보를 여기에 저장합니다. 방문자가 볼 수 있도록요.

#### 📂 Category 테이블 (카테고리)
```
어떤 정보를 저장하나요?
- 카테고리 이름 (예: "마케팅 칼럼", "바이럴 마케팅")
- URL 주소 (검색엔진용)
- 설명
- 상위 카테고리 (큰 분류 안에 작은 분류가 있을 때)
- 정렬 순서 (화면에 어떤 순서로 보여줄지)
```

**왜 필요한가요?**
- 칼럼들을 분류해서 정리하기 위해서예요. 사용자가 원하는 주제를 쉽게 찾을 수 있게 합니다.

#### 🏷️ Tag 테이블 (태그)
```
어떤 정보를 저장하나요?
- 태그 이름 (예: "병원", "바이럴", "맘카페")
- URL 주소
```

**왜 필요한가요?**
- 카테고리보다 더 세밀하게 분류하기 위해서입니다. 하나의 칼럼에 여러 태그를 붙일 수 있어요.

#### 🏠 PageContent 테이블 (홈페이지 내용)
```
어떤 정보를 저장하나요?
- 키 (예: "main_banner" - 어떤 부분인지 식별자)
- 제목
- 내용 (실제 보여줄 텍스트나 HTML)
- 타입 (텍스트/HTML/이미지 등)
```

**왜 필요한가요?**
- 홈페이지 메인 페이지의 텍스트나 배너 같은 걸 운영자가 쉽게 바꿀 수 있게 하기 위해서예요. 
- 코드 수정 없이 관리할 수 있게 됩니다.

#### 📁 Media 테이블 (업로드된 파일)
```
어떤 정보를 저장하나요?
- 원본 파일 이름
- 서버에 저장된 파일 이름
- 파일 종류 (이미지/동영상 등)
- 파일 크기
- 파일 주소 (웹에서 접근할 수 있는 URL)
- 업로드한 사람
```

**왜 필요한가요?**
- 칼럼에 이미지를 넣을 때, 또는 홈페이지에 이미지를 올릴 때 관리합니다.
- 나중에 삭제하거나 수정할 수 있게 하기 위해서예요.

---

### 🔐 2단계: 로그인 시스템 만들기

**뭘 했나요?**
- 관리자가 로그인할 수 있는 기능을 만들었습니다.
- 로그인하면 "토큰"이라는 걸 받아서, 그걸로 인증을 받습니다.

**어떻게 작동하나요?**

#### 단계 1: 비밀번호를 안전하게 저장하기
```
사용자가 입력한 비밀번호: "admin123"
↓
서버가 받아서: 특별한 암호화 방법(bcrypt)으로 변환
↓
데이터베이스에 저장: "a$b2c$d3e4f5..." (이런 식으로 알아볼 수 없게)
```

**왜 이렇게 하나요?**
- 만약 데이터베이스가 해킹당해도 비밀번호를 알아볼 수 없게 하기 위해서예요.
- 평문으로 저장하면 위험합니다.

#### 단계 2: 로그인 처리
```
1. 사용자가 이메일과 비밀번호 입력
   ↓
2. 서버가 받아서:
   - 이메일로 데이터베이스에서 사용자 찾기
   - 저장된 암호화된 비밀번호와 비교
   ↓
3. 맞으면:
   - "토큰(JWT)" 발급 (15분간 유효)
   - "리프레시 토큰" 발급 (7일간 유효)
   ↓
4. 사용자에게 토큰 전달
```

**토큰이 뭔가요?**
- 로그인한 증명서 같은 거예요.
- 다음에 API를 사용할 때 이 토큰을 보여주면 "아, 이 사람은 로그인했구나" 하고 인식합니다.
- 매번 로그인할 필요가 없어요.

#### 단계 3: 인증 확인 (미들웨어)
```
사용자가 API 호출 → "토큰 보여줘!"
↓
서버가 토큰 확인 → "맞네, 통과!"
또는
서버가 토큰 확인 → "잘못됐네, 거부!"
```

**왜 이렇게 하나요?**
- 중요한 작업(칼럼 수정, 삭제 등)은 로그인한 사람만 할 수 있게 하기 위해서예요.

---

### 📝 3단계: 칼럼(게시글) 관리 시스템

**뭘 했나요?**
- 칼럼을 올리고, 수정하고, 삭제하고, 조회하는 기능을 만들었습니다.

**어떻게 작동하나요?**

#### 칼럼 올리기 (생성)
```
1. 관리자가 웹 인터페이스에서:
   - 제목 입력: "병원 마케팅 전략"
   - 내용 입력: "병원 마케팅은..."
   - 썸네일 이미지 선택
   - 카테고리 선택: "마케팅 칼럼"
   - 태그 선택: "병원", "마케팅"
   - 상태 선택: "발행" 또는 "초안"
   ↓
2. 서버가 받아서:
   - 제목을 URL 친화적으로 변환 (예: "병원-마케팅-전략")
   - 모든 정보를 데이터베이스에 저장
   - 태그 연결 작업
   ↓
3. 저장 완료! 칼럼 ID 반환
```

**Slug가 뭔가요?**
- URL에 들어갈 주소를 만드는 거예요.
- 예: `https://example.com/columns/병원-마케팅-전략`
- 한글 제목을 그대로 쓰면 URL이 깨질 수 있어서 영어로 변환합니다.

#### 칼럼 목록 보기 (조회)
```
사용자가 "칼럼 목록 보여줘!" 요청
↓
서버가:
1. 데이터베이스에서 칼럼들 가져오기
2. 필터 적용 (카테고리별, 태그별, 검색어 등)
3. 정렬 (최신순, 인기순 등)
4. 페이지 나누기 (한 페이지에 10개씩)
↓
사용자에게 목록 전달
```

**페이지네이션이 뭔가요?**
- 한 번에 모든 칼럼을 보여주면 너무 많아서, 10개씩 나눠서 보여주는 거예요.
- 1페이지, 2페이지, 3페이지... 이렇게요.

#### 칼럼 수정하기
```
1. 관리자가 수정 요청
2. 서버가:
   - 기존 칼럼 찾기
   - 새로운 정보로 업데이트
   - 상태가 "발행"으로 바뀌면 발행일 업데이트
3. 수정 완료!
```

#### 칼럼 삭제하기
```
1. 관리자가 삭제 요청
2. 서버가 데이터베이스에서 삭제
3. 연결된 태그 정보도 자동으로 삭제
```

#### 조회수 증가
```
사용자가 칼럼 보기 클릭
↓
서버가 조회수 +1 증가
```

**왜 이렇게 하나요?**
- 인기 칼럼을 파악하기 위해서예요.

---

### 📂 4단계: 카테고리 관리 시스템

**뭘 했나요?**
- 카테고리를 만들고, 수정하고, 삭제하는 기능입니다.

**어떻게 작동하나요?**

#### 카테고리 만들기
```
관리자가 입력:
- 이름: "마케팅 칼럼"
- URL 주소: "marketing-column"
- 설명: "마케팅 관련 칼럼들"
- 상위 카테고리: 없음 (또는 다른 카테고리)
- 순서: 1
↓
서버가 데이터베이스에 저장
```

#### 계층형 카테고리가 뭔가요?
- 큰 분류 안에 작은 분류를 넣을 수 있는 거예요.
- 예:
  ```
  마케팅 칼럼 (큰 분류)
    ├─ 병원 마케팅 (작은 분류)
    ├─ 바이럴 마케팅 (작은 분류)
    └─ 블로그 관리 (작은 분류)
  ```

---

### 🏷️ 5단계: 태그 관리 시스템

**뭘 했나요?**
- 태그를 만들고, 칼럼에 여러 개 붙일 수 있게 했어요.

**어떻게 작동하나요?**

#### 태그 만들기
```
관리자가 입력:
- 이름: "병원"
- URL 주소: "hospital"
↓
서버가 저장
```

#### 칼럼에 태그 붙이기
```
칼럼 생성할 때:
- 태그 ID 리스트 전달: ["tag1", "tag2", "tag3"]
↓
서버가:
1. 칼럼 저장
2. 각 태그와 연결 테이블에 저장
```

**다대다 관계가 뭔가요?**
- 하나의 칼럼에 여러 태그를 붙일 수 있고,
- 하나의 태그가 여러 칼럼에 붙을 수 있는 관계예요.
- 그래서 중간에 연결 테이블(ColumnTag)을 만들어서 관리합니다.

---

### 🏠 6단계: 홈페이지 컨텐츠 관리

**뭘 했나요?**
- 홈페이지의 텍스트나 배너를 데이터베이스에서 관리할 수 있게 했어요.

**왜 필요한가요?**
- 기존에는 코드를 수정해야 내용을 바꿀 수 있었는데,
- 이제는 관리자가 웹 인터페이스에서 바로 수정할 수 있어요.

**어떻게 작동하나요?**

#### 컨텐츠 저장 방식 (키-값 방식)
```
키(key): "main_banner"
값(value): "<h1>환영합니다</h1>"
```

**예시:**
```
키: "header_title"
값: "오로지기획"

키: "main_banner"
값: "마케팅 전문 기업"

키: "footer_address"
값: "경기도 고양시..."
```

#### 컨텐츠 수정하기
```
1. 관리자가 "main_banner 수정해줘" 요청
2. 서버가 데이터베이스에서 찾아서 업데이트
3. 즉시 반영!
```

**Upsert가 뭔가요?**
- "있으면 업데이트, 없으면 생성"을 한 번에 하는 거예요.
- 별도로 확인할 필요 없이 한 번에 처리합니다.

---

### 📁 7단계: 파일 업로드 시스템

**뭘 했나요?**
- 이미지 파일을 서버에 업로드하고, 나중에 사용할 수 있게 했어요.

**어떻게 작동하나요?**

#### 파일 업로드 과정
```
1. 관리자가 이미지 선택
   ↓
2. 서버가 받아서:
   - 파일 이름을 고유한 이름으로 변경 (UUID 사용)
     예: "hospital.jpg" → "a1b2c3d4-e5f6-7890.jpg"
   - 업로드 폴더에 저장
   - 파일 정보를 데이터베이스에 저장
     (원본 이름, 저장된 이름, 크기, 주소 등)
   ↓
3. 사용 가능한 URL 반환
   예: "http://example.com/uploads/a1b2c3d4-e5f6-7890.jpg"
```

**왜 파일 이름을 바꾸나요?**
- 같은 이름의 파일이 여러 개 올라올 수 있어서요.
- UUID(고유 식별자)를 사용하면 중복이 안 생겨요.

#### 파일 삭제하기
```
1. 관리자가 삭제 요청
2. 서버가:
   - 데이터베이스에서 정보 삭제
   - 실제 파일도 서버에서 삭제
```

**파일 타입 제한**
- 이미지 파일만 받도록 설정 (jpg, png, gif, webp)
- 5MB 이하만 허용

**왜 이렇게 하나요?**
- 보안을 위해서예요. 악성 파일을 막기 위해서입니다.

---

### 🔗 8단계: API 엔드포인트 연결

**뭘 했나요?**
- 만든 모든 기능을 웹에서 접근할 수 있도록 URL 경로를 설정했습니다.

**API가 뭔가요?**
- 서버와 대화하는 방법이에요.
- 예를 들어, "칼럼 목록 보여줘!"라고 요청하면 서버가 데이터를 주는 거예요.

**만든 API 목록:**

#### 공개 API (로그인 없이 사용 가능)
- `GET /api/columns` - 칼럼 목록 보기
- `GET /api/columns/:id` - 칼럼 하나 보기
- `GET /api/categories` - 카테고리 목록
- `GET /api/tags` - 태그 목록
- `GET /api/page-content` - 홈페이지 내용 보기

#### 보호된 API (로그인 필요)
- `POST /api/auth/login` - 로그인
- `POST /api/columns` - 칼럼 올리기
- `PUT /api/columns/:id` - 칼럼 수정
- `DELETE /api/columns/:id` - 칼럼 삭제
- `POST /api/media/upload` - 파일 업로드
- `PUT /api/page-content/:key` - 홈페이지 내용 수정

**RESTful API가 뭔가요?**
- 일정한 규칙을 따라 만든 API예요.
- GET(가져오기), POST(만들기), PUT(수정), DELETE(삭제)를 일관되게 사용합니다.

---

### 📚 9단계: 문서화 작업

**뭘 했나요?**
- 나중에 이 코드를 이해하기 쉽도록 설명 문서를 만들었어요.

**만든 문서들:**

1. **CODE_ARCHITECTURE.md** (코드 구조 가이드)
   - 서버 코드가 어떻게 구성되어 있는지 설명
   - 각 파일의 역할 설명

2. **QUICK_REFERENCE.md** (빠른 참조 가이드)
   - 개발할 때 빠르게 참고할 수 있는 코드 템플릿
   - 자주 쓰는 패턴들

3. **ADMIN_FEATURES.md** (기능 제안 문서)
   - 지금 만든 기능 목록
   - 나중에 추가하면 좋을 기능들

4. **API_GUIDE.md** (API 사용 가이드)
   - 각 API를 어떻게 사용하는지 설명
   - 요청/응답 예시

5. **IMPLEMENTATION_SUMMARY.md** (구현 요약)
   - 오늘 작업한 내용 요약

---

### 🎯 오늘 작업의 전체 흐름

```
1. 데이터베이스 설계
   ↓
2. 로그인 시스템 (인증)
   ↓
3. 칼럼 관리 (CRUD)
   ↓
4. 카테고리 관리
   ↓
5. 태그 관리
   ↓
6. 홈페이지 컨텐츠 관리
   ↓
7. 파일 업로드
   ↓
8. API 연결
   ↓
9. 문서화
```

---

### 💡 핵심 개념 정리 (쉽게 이해하기)

#### CRUD란?
- **C**reate: 만들기 (생성)
- **R**ead: 읽기 (조회)
- **U**pdate: 업데이트 (수정)
- **D**elete: 삭제

데이터를 다루는 기본 4가지 작업이에요.

#### 레이어드 아키텍처란?
서버 코드를 역할별로 나눈 거예요:

```
1. Routes (라우터) - 요청을 받아서 어디로 보낼지 결정
   ↓
2. Controllers (컨트롤러) - 요청을 처리하고 응답을 준비
   ↓
3. Services (서비스) - 실제 비즈니스 로직 (검증, 계산 등)
   ↓
4. Repositories (저장소) - 데이터베이스 작업
   ↓
5. Database (데이터베이스) - 실제 데이터 저장
```

**왜 이렇게 나누나요?**
- 각 부분이 독립적이어서 수정하기 쉬워요.
- 테스트하기도 쉽고, 재사용하기도 좋아요.

#### 미들웨어란?
요청과 응답 사이에 끼어서 특별한 작업을 하는 거예요.

예:
- 인증 미들웨어: "로그인했나?" 확인
- 에러 처리 미들웨어: 에러가 나면 깔끔하게 처리

---

### 📊 오늘 작업 통계

- **새로 만든 파일**: 약 30개
- **추가된 코드 라인**: 약 4,000줄
- **만든 API 엔드포인트**: 20개 이상
- **데이터베이스 테이블**: 7개

---

### ✅ 다음에 할 일 (추가 기능 제안)

1. **통계 기능**
   - 어떤 칼럼이 인기 있는지
   - 일별/월별 게시글 통계

2. **검색 기능 강화**
   - 더 정교한 검색

3. **댓글 기능**
   - 칼럼에 댓글 달기

4. **이메일 알림**
   - 새 칼럼 발행 시 알림

5. **소셜 미디어 연동**
   - 칼럼 올리면 자동으로 SNS에도 올리기

---

### 🔍 용어 사전 (기획자를 위한)

| 용어 | 쉽게 설명 |
|------|----------|
| **API** | 서버와 대화하는 방법 |
| **JWT 토큰** | 로그인 증명서 |
| **미들웨어** | 요청과 응답 사이에서 작업하는 것 |
| **레포지토리** | 데이터베이스 작업만 하는 곳 |
| **서비스** | 실제 비즈니스 로직을 처리하는 곳 |
| **컨트롤러** | 요청을 받고 응답을 주는 곳 |
| **라우터** | URL 경로를 설정하는 곳 |
| **Slug** | URL에 들어가는 친화적인 주소 |
| **UUID** | 중복 없는 고유 식별자 |
| **페이지네이션** | 페이지로 나눠서 보여주기 |
| **Upsert** | 있으면 수정, 없으면 생성 |
| **다대다 관계** | 서로 여러 개 연결 가능한 관계 |

---

**작성일**: 2024년 12월 26일  
**작성자**: AI Assistant  
**목적**: 개발자 출신 기획자를 위한 쉬운 백엔드 작업 기록

